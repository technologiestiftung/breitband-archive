L.Map.mergeOptions({sleep:!0,sleepTime:750,wakeTime:750,sleepNote:!1,hoverToWake:!0,sleepOpacity:1}),L.Map.Sleep=L.Handler.extend({addHooks:function(){this.sleepNote=L.DomUtil.create("p","sleep-note",this._map._container),this._sleepMap(),this._enterTimeout=null,this._exitTimeout=null;var e=this._map.getContainer().style;e.WebkitTransition+="opacity .5s",e.MozTransition+="opacity .5s";var t=this._map.options.wakeMessage||"Click "+(this._map.options.hoverToWake?"or Hover ":"")+"to Wake",i=this.sleepNote.style;this._map.options.sleepNote&&(this.sleepNote.appendChild(document.createTextNode(t)),i.maxWidth="150px",i.transitionDuration=".2s",i.zIndex=5e3,i.opacity=".6",i.margin="auto",i.textAlign="center",i.borderRadius="4px",i.top="50%",i.position="relative",i.padding="5px",i.border="solid 2px black",i.background="white")},removeHooks:function(){this._map.scrollWheelZoom.enabled()||this._map.scrollWheelZoom.enable(),L.DomUtil.setOpacity(this._map._container,1),L.DomUtil.setOpacity(this.sleepNote,0),this._removeSleepingListeners(),this._removeAwakeListeners()},_wakeMap:function(){this._stopWaiting(),this._map.scrollWheelZoom.enable(),L.DomUtil.setOpacity(this._map._container,1),this.sleepNote.style.opacity=0,this._addAwakeListeners()},_sleepMap:function(){this._stopWaiting(),this._map.scrollWheelZoom.disable(),L.DomUtil.setOpacity(this._map._container,this._map.options.sleepOpacity),this.sleepNote.style.opacity=.4,this._addSleepingListeners()},_wakePending:function(){if(this._map.once("mousedown",this._wakeMap,this),this._map.options.hoverToWake){var e=this;this._map.once("mouseout",this._sleepMap,this),e._enterTimeout=setTimeout(function(){e._map.off("mouseout",e._sleepMap,e),e._wakeMap()},e._map.options.wakeTime)}},_sleepPending:function(){var e=this;e._map.once("mouseover",e._wakeMap,e),e._exitTimeout=setTimeout(function(){e._map.off("mouseover",e._wakeMap,e),e._sleepMap()},e._map.options.sleepTime)},_addSleepingListeners:function(){this._map.once("mouseover",this._wakePending,this)},_addAwakeListeners:function(){this._map.once("mouseout",this._sleepPending,this)},_removeSleepingListeners:function(){this._map.options.hoverToWake&&this._map.off("mouseover",this._wakePending,this),this._map.off("mousedown",this._wakeMap,this)},_removeAwakeListeners:function(){this._map.off("mouseout",this._sleepPending,this)},_stopWaiting:function(){this._removeSleepingListeners(),this._removeAwakeListeners();var e=this;this._enterTimeout&&clearTimeout(e._enterTimeout),this._exitTimeout&&clearTimeout(e._exitTimeout),this._enterTimeout=null,this._exitTimeout=null}}),L.Map.addInitHook("addHandler","sleep",L.Map.Sleep);