function stateMap(){function e(){}var t=!1,o,n=!1;return e.resize=function(){t&&(t.remove(),$("#map *").remove()),window.innerHeight/2<600?$("#map_container").css("height",.65*window.innerHeight+"px"):$("#map_container").css("height","600px"),e.build()},e.init=function(){e.resize()},e.toggleInfo=function(){n?($(".leaflet-info-btn").removeClass("leaflet-info-btn-active"),n=!1):($(".leaflet-info-btn").addClass("leaflet-info-btn-active"),n=!0)},e.build=function(){t=new L.Map("map",{center:new L.LatLng(52.5047,13.4244),zoom:11,scrollWheelZoom:!1,attributionControl:!1,hoverToWake:!1,maxZoom:18,minZoom:11,maxBounds:L.latLngBounds(L.latLng(52.3642,13.0928),L.latLng(52.6605,13.7565))}).on("click",function(){t.scrollWheelZoom.enable()}).on("zoomstart",function(){$(".leaflet-google-layer:last").css("opacity",0)});var i=new L.TileLayer("https://vislab.lupus.uberspace.de/nodejs/tiles/v2/tiles/fullimage/{z}/{x}/{y}.png").addTo(t),l=[{featureType:"all",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit.station",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"all",elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{color:"#111111"}]}],a=new L.Google("ROADMAP",{mapOptions:{styles:l}});t.addLayer(a),a.on("load",function(){console.log("load"),window.setTimeout(function(){$(".leaflet-google-layer:last").css("opacity",1)},1e3)});var r=new L.Google("SATELLITE",{});t.addLayer(r);var s=L.layerGroup(),f=!0,c=L.Control.extend({options:{position:"topright"},onAdd:function(t){var o=L.DomUtil.create("div","leaflet-brain-btn leaflet-bar leaflet-control leaflet-control-custom");return o.onclick=function(){n&&e.toggleInfo(),f?t.addLayer(s):t.removeLayer(s),f=!f},o}});t.addControl(new c);var d=L.Control.extend({options:{position:"bottomright"},onAdd:function(t){var o=L.DomUtil.create("div","leaflet-info-btn leaflet-info-btn-active leaflet-bar leaflet-control leaflet-control-custom");return o.innerHTML='<div class="infobtn">?</div><div id="map_info" class="red company-help"><strong>Berlin im Detail</strong><p><span class="image image-interactive"></span>Erkunden Sie die Berliner Breitbandlandschaft oder nutzen Sie den Button oben rechts um sich das BRAIN-Netz anzeigen zu lassen.</p></div>',o.onclick=function(){e.toggleInfo()},o}});o=new d,t.addControl(o),n=!0;var u=[[1,37,44],[1,44,27],[1,27,62],[1,62,50],[1,62,47],[1,47,60],[1,47,33],[1,60,33],[1,50,45],[1,50,35],[1,35,51],[1,51,24],[1,35,52],[1,52,53],[1,24,58],[1,58,57],[1,58,60],[1,57,38],[1,48,60],[1,48,49],[1,57,61],[1,49,41],[1,41,59],[1,59,21],[1,21,63],[1,21,63],[1,61,63],[1,56,63],[1,56,55],[1,55,54],[1,55,54],[1,54,58],[1,52,64],[1,64,24],[2,55,6],[2,55,16],[2,55,28],[2,51,15],[2,52,7],[2,27,5],[2,27,2],[2,27,19],[2,40,62],[2,62,26],[2,23,47],[2,22,37],[2,3,37],[2,8,57],[2,38,39],[2,50,14],[2,1,24],[2,63,25],[2,42,33],[2,24,20],[2,50,36],[2,24,10],[2,24,6],[2,41,19]];d3.csv("data/brain.csv",function(e,t){u.forEach(function(e,o){s.addLayer(L.polyline([new L.LatLng(t[e[1]-1].latitude,t[e[1]-1].longitude),new L.LatLng(t[e[2]-1].latitude,t[e[2]-1].longitude)],{color:"#ffffff",weight:5/e[0]}))}),t.forEach(function(e,t){s.addLayer(L.circleMarker(new L.LatLng(e.latitude,e.longitude),{radius:3*e.type,color:"#000000",fillColor:"#ffffff",weight:1,fillOpacity:1,opacity:1,title:e.name}).on("mouseover",function(e){tooltip.content('<strong class="center">'+this.options.title+"</strong>");var t=$(this._container).offset();tooltip.position([t.left+this.options.radius,t.top+this.options.radius]),tooltip.show()}).on("mouseout",function(e){tooltip.hide()}))})})},e}
